<svg viewBox="0 0 1000 1550" xmlns="http://www.w3.org/2000/svg">
  <!-- Define styles -->
  <defs>
    <style>
      .box { fill: #f8f9fa; stroke: #2c3e50; stroke-width: 2; }
      .model-box { fill: #e1f5fe; stroke: #0277bd; stroke-width: 2; }
      .compare-box { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; }
      .decision { fill: #fff9c4; stroke: #f9a825; stroke-width: 2; }
      .action { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2; }
      .result { fill: #e8f5e9; stroke: #43a047; stroke-width: 2; }
      .title-text { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #2c3e50; }
      .body-text { font-family: Arial, sans-serif; font-size: 13px; fill: #2c3e50; }
      .small-text { font-family: Arial, sans-serif; font-size: 11px; fill: #546e7a; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2c3e50" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="500" y="30" class="title-text" text-anchor="middle" font-size="18">Preliminary Analyses: Random Effects Structure</text>
  
  <!-- Step 1: Fit Random Intercepts Only Model -->
  <rect x="200" y="60" width="600" height="100" class="model-box" rx="5"/>
  <text x="500" y="85" class="title-text" text-anchor="middle">Step 1: Fit Random Intercepts Only Model</text>
  <text x="500" y="108" class="body-text" text-anchor="middle">Model 1: Y = β₀ + u₀ⱼ + rᵢⱼ</text>
  <text x="500" y="128" class="small-text" text-anchor="middle">Each participant has own baseline performance level</text>
  <text x="500" y="145" class="small-text" text-anchor="middle" font-weight="bold">Estimate using REML</text>
  
  <!-- Arrow down -->
  <path d="M 500 160 L 500 190" class="arrow"/>
  
  <!-- Step 2: Fit Random Intercepts + Slopes Model -->
  <rect x="200" y="190" width="600" height="120" class="model-box" rx="5"/>
  <text x="500" y="215" class="title-text" text-anchor="middle">Step 2: Fit Random Intercepts + Slopes Model</text>
  <text x="500" y="238" class="body-text" text-anchor="middle">Model 2: Y = (β₀ + u₀ⱼ) + (β₁ + u₁ⱼ)Time + rᵢⱼ</text>
  <text x="500" y="258" class="small-text" text-anchor="middle">Each participant has own baseline AND learning rate</text>
  <text x="500" y="275" class="small-text" text-anchor="middle">Covariance structure: Unstructured (if converges)</text>
  <text x="500" y="292" class="small-text" text-anchor="middle" font-weight="bold">Estimate using REML</text>
  
  <!-- Arrow down -->
  <path d="M 500 310 L 500 340" class="arrow"/>
  
  <!-- Step 3: Compare Models -->
  <rect x="200" y="340" width="600" height="120" class="compare-box" rx="5"/>
  <text x="500" y="365" class="title-text" text-anchor="middle">Step 3: Compare Model Fit</text>
  <text x="500" y="388" class="small-text" text-anchor="middle">• Likelihood Ratio Test (LRT): χ² test, p &lt; .05?</text>
  <text x="500" y="405" class="small-text" text-anchor="middle">• Akaike Information Criterion: ΔAIC &gt; 2?</text>
  <text x="500" y="422" class="small-text" text-anchor="middle">• Bayesian Information Criterion: ΔBIC &gt; 2?</text>
  <text x="500" y="442" class="body-text" text-anchor="middle" font-style="italic">Lower AIC/BIC indicates better fit</text>
  
  <!-- Arrow down -->
  <path d="M 500 460 L 500 500" class="arrow"/>
  
  <!-- Decision: Random Slope Improves Fit? -->
  <polygon points="500,500 700,570 500,640 300,570" class="decision"/>
  <text x="500" y="555" class="body-text" text-anchor="middle">Random slope for time</text>
  <text x="500" y="575" class="body-text" text-anchor="middle">significantly improves fit?</text>
  <text x="500" y="595" class="small-text" text-anchor="middle">(LRT p &lt; .05 OR ΔAIC/BIC &gt; 2)</text>
  
  <!-- Yes path -->
  <path d="M 700 570 L 800 570 L 800 700" class="arrow"/>
  <text x="750" y="565" class="body-text">Yes</text>
  <text x="745" y="580" class="small-text">(Expected)</text>
  
  <rect x="600" y="700" width="400" height="140" class="result" rx="5"/>
  <text x="800" y="725" class="title-text" text-anchor="middle" style="fill: #2e7d32;">Retain Random Slope for Time</text>
  <text x="800" y="748" class="body-text" text-anchor="middle" style="fill: #2e7d32;">Participants have individual learning trajectories</text>
  <text x="800" y="771" class="small-text" text-anchor="middle">Random slope will be included in all subsequent models</text>
  <text x="800" y="788" class="small-text" text-anchor="middle" font-style="italic">Rationale: Individuals learn at different rates in training</text>
  <text x="800" y="805" class="small-text" text-anchor="middle" font-style="italic">(theoretically expected and empirically supported)</text>
  <text x="800" y="825" class="body-text" text-anchor="middle" font-weight="bold">Use unstructured covariance matrix</text>
  
  <!-- Arrow from yes to covariance check -->
  <path d="M 800 840 L 800 910" class="arrow"/>
  
  <!-- No path -->
  <path d="M 300 570 L 200 570 L 200 700" class="arrow"/>
  <text x="270" y="565" class="body-text">No</text>
  <text x="240" y="580" class="small-text">(Unlikely)</text>
  
  <rect x="0" y="700" width="400" height="100" class="result" rx="5"/>
  <text x="200" y="725" class="title-text" text-anchor="middle">Random Intercepts Only</text>
  <text x="200" y="748" class="body-text" text-anchor="middle">Participants differ in baseline but not learning rate</text>
  <text x="200" y="771" class="small-text" text-anchor="middle">Random intercepts model will be used in subsequent analyses</text>
  <text x="200" y="788" class="small-text" text-anchor="middle" font-style="italic">(No random slope for time)</text>
  
  <!-- Arrow from no to final step -->
  <path d="M 200 800 L 200 1050 L 500 1050 L 500 1080" class="arrow"/>
  
  <!-- Covariance Decision -->
  <polygon points="800,910 950,970 800,1030 650,970" class="decision"/>
  <text x="800" y="960" class="body-text" text-anchor="middle">Model with</text>
  <text x="800" y="980" class="body-text" text-anchor="middle">unstructured</text>
  <text x="800" y="1000" class="body-text" text-anchor="middle">covariance converges?</text>
  
  <!-- Yes - unstructured -->
  <path d="M 800 1030 L 800 1050 L 500 1050 L 500 1080" class="arrow"/>
  <text x="770" y="1045" class="body-text">Yes</text>
  
  <!-- No - variance components -->
  <path d="M 950 970 L 1000 970 L 1000 1100 L 650 1100" class="arrow"/>
  <text x="970" y="965" class="body-text">No</text>
  
  <rect x="650" y="1100" width="300" height="80" class="action" rx="5"/>
  <text x="800" y="1125" class="title-text" text-anchor="middle">Use Variance Components</text>
  <text x="800" y="1148" class="body-text" text-anchor="middle">Structure instead</text>
  <text x="800" y="1168" class="small-text" text-anchor="middle">(Assumes zero covariance between</text>
  <text x="800" y="1182" class="small-text" text-anchor="middle">random intercept and slope)</text>
  
  <!-- Arrow from variance components to final -->
  <path d="M 800 1180 L 800 1230 L 500 1230 L 500 1260" class="arrow"/>
  
  <!-- Final Documentation Step -->
  <rect x="200" y="1080" width="600" height="100" class="box" rx="5"/>
  <text x="500" y="1105" class="title-text" text-anchor="middle">Step 4: Document Random Effects Structure</text>
  <text x="500" y="1128" class="small-text" text-anchor="middle">• Report model comparison results (LRT, AIC, BIC)</text>
  <text x="500" y="1145" class="small-text" text-anchor="middle">• Specify which random effects structure will be used</text>
  <text x="500" y="1162" class="small-text" text-anchor="middle">• Report covariance structure (unstructured or variance components)</text>
  
  <!-- Arrow to final step -->
  <path d="M 500 1180 L 500 1260" class="arrow"/>
  
  <!-- End box -->
  <rect x="250" y="1260" width="500" height="60" class="box" rx="5" style="fill: #e8f5e9; stroke: #43a047;"/>
  <text x="500" y="1285" class="title-text" text-anchor="middle" style="fill: #2e7d32;">Proceed to Model Comparison</text>
  <text x="500" y="1305" class="title-text" text-anchor="middle" style="fill: #2e7d32;">Strategy (Fixed Effects)</text>
  
  <!-- Side info box - Estimation -->
  <rect x="50" y="60" width="130" height="110" style="fill: #e3f2fd; stroke: #0277bd; stroke-width: 1;" rx="3"/>
  <text x="115" y="80" class="small-text" text-anchor="middle" font-weight="bold">Why REML?</text>
  <text x="60" y="100" class="small-text">REML produces</text>
  <text x="60" y="115" class="small-text">unbiased estimates of</text>
  <text x="60" y="130" class="small-text">variance components</text>
  <text x="60" y="145" class="small-text">when comparing</text>
  <text x="60" y="160" class="small-text">random effects</text>
  
  <!-- Side info box - Fit Indices -->
  <rect x="820" y="340" width="130" height="120" style="fill: #fff3e0; stroke: #f57c00; stroke-width: 1;" rx="3"/>
  <text x="885" y="360" class="small-text" text-anchor="middle" font-weight="bold">Fit Criteria:</text>
  <text x="830" y="380" class="small-text">LRT: p &lt; .05</text>
  <text x="830" y="398" class="small-text">ΔAIC &gt; 2</text>
  <text x="830" y="416" class="small-text">ΔBIC &gt; 2</text>
  <line x1="830" y1="428" x2="940" y2="428" stroke="#f57c00" stroke-width="0.5"/>
  <text x="830" y="443" class="small-text" font-style="italic">Lower values =</text>
  <text x="830" y="456" class="small-text" font-style="italic">better fit</text>
  
  <!-- References footer -->
  <rect x="50" y="1340" width="900" height="80" style="fill: #fafafa; stroke: #bdbdbd; stroke-width: 1;" rx="3"/>
  <text x="70" y="1360" class="small-text" font-weight="bold">Key References and Rationale:</text>
  <text x="70" y="1378" class="small-text">• REML for random effects comparison: Raudenbush and Bryk (2002)</text>
  <text x="70" y="1393" class="small-text">• Fit indices thresholds: Garson (2023) - ΔAIC/BIC &gt; 2, LRT p &lt; .05</text>
  <text x="70" y="1408" class="small-text">• Theoretical expectation: Individuals learn at different rates in training contexts, suggesting random slopes</text>
  <text x="70" y="1423" class="small-text">  should improve fit by capturing individual variability in learning trajectories</text>
</svg>